"use strict";(self["webpackChunktaiwan_tour"]=self["webpackChunktaiwan_tour"]||[]).push([[381],{179:function(e,t,i){var s=i(6163);t["Z"]={getActivity({area:e,select:t,filter:i,orderby:a,top:n,skip:o}){return s.l.get(`/Activity/${e}?${t}${i}${a}${n}${o}%24format=JSON`)},getAllActivity({filter:e,top:t,skip:i}){return s.l.get(`/Activity?${e}${t}${i}%24format=JSON`)}}},7381:function(e,t,i){i.r(t),i.d(t,{default:function(){return H}});var s=i(6252),a=i(9963);const n={class:"container"},o={key:0},r={key:0},c={key:1},l={key:0,class:"btn-section"},d=["disabled"],u={key:0,class:"spinner-border spinner-border-sm text-light",role:"status"},p=(0,s._)("span",{class:"visually-hidden"},"Loading...",-1),v=[p],y={key:1};function m(e,t,i,p,m,$){const g=(0,s.up)("MainHead"),C=(0,s.up)("SlideSpot"),f=(0,s.up)("SpotList");return(0,s.wg)(),(0,s.iD)("div",n,[(0,s.Wm)(g),(0,s.Wm)(a.uT,{name:"slide"},{default:(0,s.w5)((()=>[p.isSlideLoading?((0,s.wg)(),(0,s.iD)("div",o)):((0,s.wg)(),(0,s.j4)(C,{key:1,spots:p.activitySlide},null,8,["spots"]))])),_:1}),(0,s.Wm)(a.uT,{name:"cardList"},{default:(0,s.w5)((()=>[p.isLoading?((0,s.wg)(),(0,s.iD)("div",r)):((0,s.wg)(),(0,s.iD)("div",c,[(0,s.Wm)(f,{cardList:p.activityList},null,8,["cardList"]),p.activityList.length===p.top?((0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("button",{onClick:t[0]||(t[0]=(...e)=>p.showMore&&p.showMore(...e)),class:"moreBtn btn btn-primary",disabled:p.isLoading},[p.isProcessing?((0,s.wg)(),(0,s.iD)("div",u,v)):((0,s.wg)(),(0,s.iD)("span",y,"更多活動"))],8,d)])):(0,s.kq)("",!0)]))])),_:1})])}var $=i(9673),g=i(6710),C=i(2339),f=i(179),w=i(3907),A=i(2262),k=i(2201),h={components:{MainHead:$.Z,SlideSpot:g.Z,SpotList:C.Z},setup(){const e=(0,A.iH)(0),t=(0,A.iH)(12),i=(0,A.iH)(""),a=(0,A.iH)(""),n=(0,A.iH)(""),o=(0,A.iH)([]),r=(0,A.qj)([]),c=(0,A.iH)(!1),l=(0,A.iH)(!1),d=(0,A.iH)(!1),u=(0,w.oR)(),p=(0,s.Fl)((()=>u.state.currentArea)),v=(0,k.yj)(),y=(0,A.iH)(v.params.area),m=async()=>{l.value=!0;let e=30,t=0;const i=[],{data:s}=await f.Z.getActivity({area:p.value.enName,select:"",filter:"",top:`${encodeURIComponent("$")}top=${e}&`,skip:`${encodeURIComponent("$")}skip=${t}&`});if(s.length>=5)for(let a=s.length-1;a>s.length-6;a--)i.unshift({id:s[a].ActivityID,address:s[a].Address?s[a].Address:s[a].City,city:s[a].City,picture:s[a].Picture?s[a].Picture:{},name:s[a].ActivityName}),o.value=i;else for(let a=0;a<s.length;a++)i.unshift({id:s[a].ActivityID,address:s[a].Address?s[a].Address:"",city:s[a].City,picture:s[a].Picture?s[a].Picture:{},name:s[a].ActivityName}),o.value=i;l.value=!1},$=async()=>{c.value=!0;let s=[];const{data:o}=await f.Z.getActivity({area:p.value.enName,select:i.value?`${encodeURIComponent("$")}select=${i.value}&`:"",filter:a.value?`${encodeURIComponent("$")}filter=${encodeURIComponent(`contains(${a.value}, '${n.value}')`)}&`:"",orderby:`${encodeURIComponent("$")}orderby=${encodeURIComponent("EndTime desc")}&`,top:`${encodeURIComponent("$")}top=${t.value}&`,skip:`${encodeURIComponent("$")}skip=${e.value}&`});s=o.map((e=>({id:e.ActivityID,address:e.Address?e.Address:e.City,city:e.City,class1:e.Class1?e.Class1:"",class2:e.Class2?e.Class2:"",class3:e.Class3?e.Clas3:"",description:e.Description,openTime:e.Cycle,phone:e.Phone,picture:e.Picture?e.Picture:{},position:e.Position,name:e.ActivityName}))),r.push(...s),c.value=!1};(0,s.wF)(m),(0,s.wF)($);const g=()=>{d.value=!0,e.value+=12,setTimeout((()=>{$(),d.value=!1}),1e3)};return(0,k.ao)((i=>{const{area:s}=i.params;t.value=12,e.value=0,r.splice(0,r.length),y.value!==s&&(y.value=s,m(),$())})),{skip:e,top:t,selectName:i,category:a,categoryName:n,activitySlide:o,activityList:r,isLoading:c,isSlideLoading:l,isProcessing:d,currentArea:p,showMore:g}}},L=i(3744);const b=(0,L.Z)(h,[["render",m]]);var H=b}}]);
//# sourceMappingURL=381.ce480ad8.js.map