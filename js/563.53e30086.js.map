{"version":3,"file":"js/563.53e30086.js","mappings":"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","sources":["webpack://taiwan-tour/./src/apis/hotelStay.js","webpack://taiwan-tour/./src/views/HostelStay.vue","webpack://taiwan-tour/./src/views/HostelStay.vue?01d0"],"sourcesContent":["import { apiHelper } from \"@/utils/helpers\";\r\nexport default{\r\n  getHotel({area,select,filter,top,skip}){\r\n    return apiHelper.get(`/Hotel/${area}?${select}${filter}${top}${skip}%24format=JSON`)\r\n  },\r\n  getAllHotel({filter,top,skip}){\r\n    return apiHelper.get(`/Hotel?${filter}${top}${skip}%24format=JSON`)\r\n  }\r\n}","<template>\r\n  <div class=\"container\">\r\n    <MainHead />\r\n    <Transition name=\"slide\">\r\n      <div v-if=\"isSlideLoading\"></div>\r\n      <SlideSpot v-else :spots=\"hotelSlide\" />\r\n    </Transition>\r\n    <Transition name=\"cardList\">\r\n      <div v-if=\"isLoading\"></div>\r\n      <div v-else>\r\n        <SpotList :cardList=\"hotelList\" />\r\n        <div v-if=\"hotelList.length !== 0\" class=\"btn-section\">\r\n          <button\r\n            @click=\"showMore\"\r\n            class=\"moreBtn btn btn-primary\"\r\n            :disabled=\"isLoading\"\r\n          >\r\n            <div\r\n              v-if=\"isProcessing\"\r\n              class=\"spinner-border spinner-border-sm text-light\"\r\n              role=\"status\"\r\n            >\r\n              <span class=\"visually-hidden\">Loading...</span>\r\n            </div>\r\n            <span v-else>更多旅館</span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </Transition>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport MainHead from \"./../components/MainHead.vue\";\r\nimport SlideSpot from \"./../components/SlideSpot.vue\";\r\nimport SpotList from \"./../components/SpotList.vue\";\r\nimport hotelAPI from \"./../apis/hotelStay\";\r\nimport { useStore } from \"vuex\";\r\nimport { ref, reactive, computed, onBeforeMount } from \"vue\";\r\nimport { useRoute, onBeforeRouteUpdate } from \"vue-router\";\r\nexport default {\r\n  components: {\r\n    MainHead,\r\n    SlideSpot,\r\n    SpotList,\r\n  },\r\n  setup() {\r\n    const skip = ref(0);\r\n    const top = ref(12);\r\n    const selectName = ref(\"\");\r\n    const category = ref(\"\");\r\n    const categoryName = ref(\"\");\r\n    const hotelSlide = ref([]);\r\n    const hotelList = reactive([]);\r\n    const isLoading = ref(false);\r\n    const isSlideLoading = ref(false);\r\n    const isProcessing = ref(false);\r\n    const store = useStore();\r\n    const currentArea = computed(() => store.state.currentArea);\r\n    const route = useRoute();\r\n    const area = ref(route.params.area);\r\n    const fetchHotelSlide = async () => {\r\n      isSlideLoading.value = true;\r\n      let top = 25;\r\n      let skip = Math.floor(Math.random() * 9) + 1;\r\n      let count = top / 5;\r\n      let tempObj = [];\r\n      const { data } = await hotelAPI.getHotel({\r\n        area: currentArea.value.enName,\r\n        select: \"\",\r\n        filter: \"\",\r\n        top: `${encodeURIComponent(\"$\")}top=${top}&`,\r\n        skip: `${encodeURIComponent(\"$\")}skip=${skip}&`,\r\n      });\r\n      for (let i = 0; i < 5; i++) {\r\n        tempObj.push({\r\n          id: data[count - 1].HotelID,\r\n          address: data[count - 1].Address\r\n            ? data[count - 1].Address\r\n            : data[count - 1].City,\r\n          city: data[count - 1].City,\r\n          picture: data[count - 1].Picture ? data[count - 1].Picture : {},\r\n          name: data[count - 1].HotelName,\r\n        });\r\n        count += top / 5;\r\n      }\r\n      hotelSlide.value = tempObj;\r\n      isSlideLoading.value = false;\r\n    };\r\n    const fetchHotel = async () => {\r\n      isLoading.value = true;\r\n      let tempArr = [];\r\n      const { data } = await hotelAPI.getHotel({\r\n        area: currentArea.value.enName,\r\n        select: selectName.value\r\n          ? `${encodeURIComponent(\"$\")}select=${selectName.value}&`\r\n          : \"\",\r\n        filter: category.value\r\n          ? `${encodeURIComponent(\"$\")}filter=${encodeURIComponent(\r\n              `contains(${category.value}, '${categoryName.value}')`\r\n            )}&`\r\n          : \"\",\r\n        top: `${encodeURIComponent(\"$\")}top=${top.value}&`,\r\n        skip: `${encodeURIComponent(\"$\")}skip=${skip.value}&`,\r\n      });\r\n      tempArr = data.map((card) => ({\r\n        id: card.HotelID,\r\n        address: card.Address ? card.Address : card.City,\r\n        city: card.City,\r\n        class1: card.Class ? card.Class : \"\",\r\n        class2: \"\",\r\n        class3: \"\",\r\n        description: card.Description,\r\n        openTime: card.OpenTime,\r\n        phone: card.Phone,\r\n        picture: card.Picture ? card.Picture : {},\r\n        position: card.Position,\r\n        name: card.HotelName,\r\n      }));\r\n      hotelList.push(...tempArr);\r\n      isLoading.value = false;\r\n    };\r\n    onBeforeMount(fetchHotelSlide);\r\n    onBeforeMount(fetchHotel);\r\n    const showMore = () => {\r\n      isProcessing.value = true;\r\n      skip.value += 12;\r\n      setTimeout(() => {\r\n        fetchHotel();\r\n        isProcessing.value = false;\r\n      }, 1000);\r\n    };\r\n    onBeforeRouteUpdate((to) => {\r\n      const { area: newArea } = to.params;\r\n      top.value = 12;\r\n      skip.value = 0;\r\n      hotelList.splice(0, hotelList.length);\r\n      if (area.value !== newArea) {\r\n        area.value = newArea;\r\n        fetchHotelSlide();\r\n        fetchHotel();\r\n      }\r\n    });\r\n    return {\r\n      skip,\r\n      top,\r\n      selectName,\r\n      category,\r\n      categoryName,\r\n      hotelSlide,\r\n      hotelList,\r\n      isLoading,\r\n      isSlideLoading,\r\n      isProcessing,\r\n      currentArea,\r\n      showMore,\r\n    };\r\n  },\r\n};\r\n</script>\r\n","import { render } from \"./HostelStay.vue?vue&type=template&id=7520d9eb\"\nimport script from \"./HostelStay.vue?vue&type=script&lang=js\"\nexport * from \"./HostelStay.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\ac-project\\\\taiwan-tour\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["getHotel","area","select","filter","top","skip","apiHelper","getAllHotel","class","role","_createElementVNode","_hoisted_8","_createElementBlock","_createVNode","_component_MainHead","_Transition","name","$setup","_hoisted_2","_createBlock","_component_SlideSpot","spots","_hoisted_3","_hoisted_4","_component_SpotList","cardList","length","onClick","disabled","_hoisted_9","_hoisted_10","components","MainHead","SlideSpot","SpotList","setup","ref","selectName","category","categoryName","hotelSlide","hotelList","reactive","isLoading","isSlideLoading","isProcessing","store","useStore","currentArea","computed","state","route","useRoute","params","fetchHotelSlide","async","value","Math","floor","random","count","tempObj","data","hotelAPI","enName","encodeURIComponent","i","push","id","HotelID","address","Address","City","city","picture","Picture","HotelName","fetchHotel","tempArr","map","card","class1","Class","class2","class3","description","Description","openTime","OpenTime","phone","Phone","position","Position","onBeforeMount","showMore","setTimeout","onBeforeRouteUpdate","to","newArea","splice","__exports__","render"],"sourceRoot":""}